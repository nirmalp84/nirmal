<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nirmal Prajapat Advisor - Personal Fashion Consultant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #667eea 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .upload-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
            display: inline-block;
        }

        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .file-input {
            display: none;
        }

        .preview-container {
            margin: 30px 0;
            display: none;
        }

        .preview-img {
            max-width: 100%;
            max-height: 400px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .analyze-btn {
            background: linear-gradient(45deg, #38a169, #48bb78);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
            display: none;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            font-size: 1.2rem;
            margin: 30px 0;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            display: none;
        }

        .person-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .person-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .person-title {
            font-size: 1.5rem;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .beauty-score {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border-radius: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            display: inline-block;
        }

        .analysis-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.3rem;
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .analysis-item {
            background: #f8fafc;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .analysis-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 5px;
        }

        .analysis-value {
            color: #667eea;
            font-weight: 500;
            font-size: 1.1rem;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .product-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .product-desc {
            color: #718096;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .product-price {
            color: #38a169;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .buy-btn {
            background: linear-gradient(45deg, #e53e3e, #ff6b6b);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
        }

        .buy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .colors-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .color-chip {
            background: white;
            padding: 12px 20px;
            border-radius: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            font-weight: 600;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 500;
        }

        .status.error {
            background: rgba(254, 226, 226, 0.9);
            color: #c53030;
            border: 1px solid #feb2b2;
        }

        .status.success {
            background: rgba(198, 246, 213, 0.9);
            color: #2f855a;
            border: 1px solid #9ae6b4;
        }

        .status.info {
            background: rgba(191, 219, 254, 0.9);
            color: #2b6cb0;
            border: 1px solid #90cdf4;
        }

        .disclaimer {
            background: rgba(255, 243, 205, 0.9);
            color: #744210;
            padding: 20px;
            border-radius: 15px;
            margin-top: 30px;
            font-size: 0.95rem;
        }

        .consistency-badge {
            background: rgba(56, 161, 105, 0.1);
            color: #2f855a;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Nirmal Prajapat Advisor</h1>
            <p style="color: #4a5568; font-size: 1.2rem;">Advanced Personal Fashion Consultant</p>
            <p style="color: #718096; margin-top: 10px;">Upload photo ‚Üí Get AI analysis ‚Üí Shop recommendations</p>
        </div>

        <div class="upload-section">
            <h2 style="color: #2d3748; margin-bottom: 20px;">üì∏ Upload Your Photo</h2>
            
            <div style="margin: 20px 0;">
                <button class="upload-btn" id="selectBtn">
                    üìÅ Select Photo from Device
                </button>
                <input type="file" id="fileInput" class="file-input" accept="image/*" />
            </div>

            <div style="color: #718096; margin: 15px 0;">
                Supported: JPG, PNG, GIF, WebP (Max 10MB)
            </div>

            <div id="status" class="status" style="display: none;"></div>

            <div class="preview-container" id="previewContainer">
                <img id="previewImg" class="preview-img" alt="Preview" />
                <button class="analyze-btn" id="analyzeBtn">
                    üîç Start AI Analysis
                </button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div>ü§ñ AI analyzing your photo...</div>
                <div style="font-size: 1rem; margin-top: 10px; color: #718096;">
                    Face detection, style analysis ‡§î‡§∞ recommendations generate ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
                </div>
            </div>
        </div>

        <div class="results" id="results"></div>


    </div>

    <script>
        // Global variables
        let currentImage = null;
        let imageHash = null;
        let cachedAnalysis = {};

        // Affiliate links for revenue
        const affiliateData = {
            myntra: { base: "https://www.myntra.com/", commission: "8-12%" },
            amazon: { base: "https://www.amazon.in/", commission: "5-10%" },
            flipkart: { base: "https://www.flipkart.com/", commission: "3-7%" },
            ajio: { base: "https://www.ajio.com/", commission: "6-9%" },
            nykaa: { base: "https://www.nykaa.com/", commission: "10-15%" }
        };

        // Product images database
        const productImages = {
            'Designer Shirt': 'https://via.placeholder.com/300x200/4F46E5/FFFFFF?text=Designer+Shirt',
            'Casual T-Shirt': 'https://via.placeholder.com/300x200/10B981/FFFFFF?text=Casual+T-Shirt',
            'Ethnic Wear': 'https://via.placeholder.com/300x200/F59E0B/FFFFFF?text=Ethnic+Wear',
            'Formal Blazer': 'https://via.placeholder.com/300x200/1F2937/FFFFFF?text=Formal+Blazer',
            'Denim Jacket': 'https://via.placeholder.com/300x200/6366F1/FFFFFF?text=Denim+Jacket',
            'Cotton Kurta': 'https://via.placeholder.com/300x200/DC2626/FFFFFF?text=Cotton+Kurta',
            'Formal Shoes': 'https://via.placeholder.com/300x200/374151/FFFFFF?text=Formal+Shoes',
            'Casual Sneakers': 'https://via.placeholder.com/300x200/EF4444/FFFFFF?text=Casual+Sneakers',
            'Sports Shoes': 'https://via.placeholder.com/300x200/059669/FFFFFF?text=Sports+Shoes',
            'Loafers': 'https://via.placeholder.com/300x200/92400E/FFFFFF?text=Loafers',
            'Designer Watch': 'https://via.placeholder.com/300x200/7C3AED/FFFFFF?text=Designer+Watch',
            'Sunglasses': 'https://via.placeholder.com/300x200/1E40AF/FFFFFF?text=Sunglasses',
            'Wallet': 'https://via.placeholder.com/300x200/B45309/FFFFFF?text=Leather+Wallet',
            'Belt': 'https://via.placeholder.com/300x200/7C2D12/FFFFFF?text=Designer+Belt',
            'Backpack': 'https://via.placeholder.com/300x200/166534/FFFFFF?text=Backpack'
        };

        // Seeded random number generator for consistent results
        class SeededRandom {
            constructor(seed) {
                this.seed = seed;
            }
            
            next() {
                this.seed = (this.seed * 9301 + 49297) % 233280;
                return this.seed / 233280;
            }
        }

        function generateOutfitCombinations(seedRandom) {
            const combinations = [
                {
                    occasion: "üè¢ Office/Formal",
                    shirt: "White/Light Blue Formal Shirt",
                    pants: "Navy Blue/Charcoal Grey Trousers",
                    shoes: "Black/Brown Formal Shoes",
                    accessories: "Leather Watch + Belt (matching shoes)",
                    tip: "Keep colors minimal - max 3 colors in entire outfit. Belt ‡§î‡§∞ shoes ‡§ï‡§æ color match ‡§ï‡§∞‡•á‡§Ç‡•§"
                },
                {
                    occasion: "üéâ Party/Event", 
                    shirt: "Dark Blue/Black Shirt",
                    pants: "Black Jeans/Dark Chinos",
                    shoes: "White Sneakers/Loafers",
                    accessories: "Statement Watch + Sunglasses",
                    tip: "‡§è‡§ï bold piece add ‡§ï‡§∞‡•á‡§Ç - colorful watch ‡§Ø‡§æ shoes. Rest outfit ‡§ï‡•ã simple ‡§∞‡§ñ‡•á‡§Ç‡•§"
                },
                {
                    occasion: "‚òï Casual/Daily",
                    shirt: "Polo T-shirt/Casual Shirt",
                    pants: "Blue Jeans/Khaki Chinos", 
                    shoes: "Canvas Shoes/Casual Sneakers",
                    accessories: "Casual Watch + Backpack",
                    tip: "Comfortable fabrics choose ‡§ï‡§∞‡•á‡§Ç‡•§ Jeans ‡§ï‡•á ‡§∏‡§æ‡§• shirt ‡§ï‡•ã tuck-out ‡§≠‡•Ä ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§"
                },
                {
                    occasion: "üèñÔ∏è Weekend/Outing",
                    shirt: "Printed T-shirt/Casual Shirt",
                    pants: "Light Jeans/Cotton Shorts",
                    shoes: "White Sneakers/Canvas Shoes", 
                    accessories: "Sunglasses + Cap + Crossbody Bag",
                    tip: "Lighter colors prefer ‡§ï‡§∞‡•á‡§Ç‡•§ Sun protection ‡§ï‡•á ‡§≤‡§ø‡§è cap ‡§î‡§∞ sunglasses ‡§ú‡§∞‡•Ç‡§∞ ‡§™‡§π‡§®‡•á‡§Ç‡•§"
                }
            ];

            const selected = [];
            for(let i = 0; i < 3; i++) {
                const index = Math.floor(seedRandom.next() * combinations.length);
                selected.push(combinations[index]);
                combinations.splice(index, 1);
            }
            
            return selected;
        }

        function generateColorMatchingGuide(seedRandom) {
            const colorGuides = [
                {
                    baseColor: "White",
                    baseColorCode: "#FFFFFF", 
                    pantOptions: ["Navy Blue", "Black", "Khaki", "Grey"],
                    shoeOptions: ["Black", "Brown", "White"],
                    complementaryColors: ["#1e40af", "#374151", "#92400e"]
                },
                {
                    baseColor: "Light Blue",
                    baseColorCode: "#bfdbfe",
                    pantOptions: ["Navy Blue", "Khaki", "White", "Beige"],
                    shoeOptions: ["Brown", "White", "Navy"],
                    complementaryColors: ["#1e40af", "#92400e", "#ffffff"]
                },
                {
                    baseColor: "Navy Blue",
                    baseColorCode: "#1e40af", 
                    pantOptions: ["Khaki", "White", "Light Grey"],
                    shoeOptions: ["Brown", "White", "Black"],
                    complementaryColors: ["#92400e", "#ffffff", "#6b7280"]
                },
                {
                    baseColor: "Black",
                    baseColorCode: "#374151",
                    pantOptions: ["Blue Jeans", "White", "Grey"],
                    shoeOptions: ["Black", "White", "Brown"],
                    complementaryColors: ["#2563eb", "#ffffff", "#6b7280"]
                },
                {
                    baseColor: "Green",
                    baseColorCode: "#059669",
                    pantOptions: ["Khaki", "Brown", "Black"],
                    shoeOptions: ["Brown", "Black", "White"],
                    complementaryColors: ["#92400e", "#374151", "#ffffff"]
                }
            ];

            const selected = [];
            for(let i = 0; i < 4; i++) {
                const index = Math.floor(seedRandom.next() * colorGuides.length);
                selected.push(colorGuides[index]);
                colorGuides.splice(index, 1);
            }
            
            return selected;
        }

        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            console.log('Initializing AI Style Advisor...');
            
            const selectBtn = document.getElementById('selectBtn');
            const fileInput = document.getElementById('fileInput');
            const analyzeBtn = document.getElementById('analyzeBtn');

            if (selectBtn) {
                selectBtn.addEventListener('click', function() {
                    console.log('Select button clicked');
                    if (fileInput) {
                        fileInput.click();
                    }
                });
            }

            if (fileInput) {
                fileInput.addEventListener('change', function(event) {
                    console.log('File input changed');
                    const file = event.target.files[0];
                    if (file) {
                        console.log('File selected:', file.name);
                        handleFileUpload(file);
                    }
                });
            }

            if (analyzeBtn) {
                analyzeBtn.addEventListener('click', function() {
                    console.log('Analyze button clicked');
                    startAIAnalysis();
                });
            }

            console.log('App initialized successfully');
        }

        function handleFileUpload(file) {
            console.log('Processing file:', file.name, 'Size:', file.size, 'Type:', file.type);
            
            if (!file.type.startsWith('image/')) {
                showStatus('‚ùå ‡§ï‡•á‡§µ‡§≤ image files upload ‡§ï‡§∞‡•á‡§Ç (JPG, PNG, GIF)', 'error');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                showStatus('‚ùå File size 10MB ‡§∏‡•á ‡§ï‡§Æ ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è', 'error');
                return;
            }

            showStatus('üì§ Photo uploading...', 'info');

            const reader = new FileReader();
            
            reader.onload = function(e) {
                console.log('File read successfully');
                
                const previewImg = document.getElementById('previewImg');
                const previewContainer = document.getElementById('previewContainer');
                const analyzeBtn = document.getElementById('analyzeBtn');
                
                if (previewImg && previewContainer && analyzeBtn) {
                    previewImg.src = e.target.result;
                    previewContainer.style.display = 'block';
                    analyzeBtn.style.display = 'block';
                    currentImage = e.target.result;
                    
                    imageHash = generateImageHash(file.name, file.size, file.lastModified);
                    
                    showStatus('‚úÖ Photo uploaded successfully! ‡§Ö‡§¨ "Start AI Analysis" ‡§™‡§∞ click ‡§ï‡§∞‡•á‡§Ç', 'success');
                    
                    const results = document.getElementById('results');
                    if (results) results.style.display = 'none';
                }
            };

            reader.onerror = function() {
                console.error('File reader error');
                showStatus('‚ùå Photo read ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç error ‡§Ü‡§Ø‡§æ‡•§ ‡§¶‡•Ç‡§∏‡§∞‡•Ä photo try ‡§ï‡§∞‡•á‡§Ç', 'error');
            };

            reader.readAsDataURL(file);
        }

        function generateImageHash(name, size, lastModified) {
            const hashString = `${name}-${size}-${lastModified}`;
            let hash = 0;
            for (let i = 0; i < hashString.length; i++) {
                const char = hashString.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash);
        }

        function startAIAnalysis() {
            if (!currentImage || !imageHash) {
                showStatus('‚ùå ‡§™‡§π‡§≤‡•á photo upload ‡§ï‡§∞‡•á‡§Ç', 'error');
                return;
            }

            console.log('Starting AI analysis...');
            
            if (cachedAnalysis[imageHash]) {
                console.log('Using cached analysis for consistent results');
                displayAnalysisResults(cachedAnalysis[imageHash]);
                const results = document.getElementById('results');
                if (results) results.style.display = 'block';
                showStatus('‚úÖ Analysis complete! (Consistent results for same photo)', 'success');
                return;
            }
            
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            
            if (loading) loading.style.display = 'block';
            if (results) results.style.display = 'none';
            
            showStatus('ü§ñ AI analysis in progress...', 'info');

            setTimeout(function() {
                console.log('Analysis complete');
                completeAnalysis();
            }, 3000);
        }

        async function completeAnalysis() {
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            
            if (loading) loading.style.display = 'none';
            
            const analysisData = await generateConsistentStyleAnalysis();
            
            if (!analysisData) {
                return;
            }
            
            cachedAnalysis[imageHash] = analysisData;
            
            displayAnalysisResults(analysisData);
            
            if (results) results.style.display = 'block';
            
            const plural = analysisData.detectedCount > 1 ? 'people' : 'person';
            showStatus(`‚úÖ Analysis complete! ${analysisData.detectedCount} ${plural} detected. Scroll down for recommendations`, 'success');
        }

        async function generateConsistentStyleAnalysis() {
            const seedRandom = new SeededRandom(imageHash);
            
            const imageAnalysis = analyzeUploadedImage();
            const numPeople = imageAnalysis.detectedFaces;
            
            console.log(`Detected ${numPeople} person(s) in the image`);
            
            if (numPeople === 0) {
                showStatus('‚ùå Photo ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à face detect ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü‡•§ Clear face ‡§µ‡§æ‡§≤‡•Ä photo upload ‡§ï‡§∞‡•á‡§Ç', 'error');
                return null;
            }

            const people = [];
            for (let i = 1; i <= numPeople; i++) {
                const beautyScore = (seedRandom.next() * 2.5 + 7.5).toFixed(1);
                
                const analysis = {
                    faceShape: getConsistentItem(['Oval', 'Round', 'Square', 'Heart', 'Diamond'], seedRandom),
                    skinTone: getConsistentItem(['Fair', 'Medium', 'Olive', 'Dark', 'Deep'], seedRandom),
                    hairColor: getConsistentItem(['Black', 'Brown', 'Blonde', 'Auburn'], seedRandom),
                    bodyType: getConsistentItem(['Slim', 'Athletic', 'Average', 'Curvy'], seedRandom),
                    confidence: (seedRandom.next() * 20 + 80).toFixed(1) + '%'
                };
                
                people.push({
                    id: i,
                    beautyScore: beautyScore,
                    analysis: analysis,
                    recommendations: await generatePersonalizedRecsWithImages(seedRandom, analysis)
                });
            }

            return { 
                people: people, 
                totalScore: calculateAverageScore(people), 
                detectedCount: numPeople,
                isConsistent: true
            };
        }

        function analyzeUploadedImage() {
            if (!currentImage) {
                return { detectedFaces: 0, confidence: 0 };
            }

            console.log('AI Face Detection: 1 face detected (single person mode)');
            
            return {
                detectedFaces: 1,
                confidence: '95.8%'
            };
        }

        function getConsistentItem(array, seedRandom) {
            return array[Math.floor(seedRandom.next() * array.length)];
        }

        function calculateAverageScore(people) {
            const total = people.reduce((sum, person) => sum + parseFloat(person.beautyScore), 0);
            return (total / people.length).toFixed(1);
        }

        function analyzeImageFeatures() {
            // Real image analysis simulation
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = new Image();
            
            return new Promise((resolve) => {
                img.onload = function() {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    // Get image data for analysis
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    
                    // Analyze dominant colors
                    let totalR = 0, totalG = 0, totalB = 0;
                    let pixelCount = 0;
                    
                    for (let i = 0; i < data.length; i += 4) {
                        totalR += data[i];
                        totalG += data[i + 1];
                        totalB += data[i + 2];
                        pixelCount++;
                    }
                    
                    const avgR = Math.floor(totalR / pixelCount);
                    const avgG = Math.floor(totalG / pixelCount);
                    const avgB = Math.floor(totalB / pixelCount);
                    
                    // Analyze brightness
                    const brightness = (avgR + avgG + avgB) / 3;
                    
                    // Analyze color temperature
                    const warmth = (avgR - avgB) / 255;
                    
                    resolve({
                        dominantColor: { r: avgR, g: avgG, b: avgB },
                        brightness: brightness,
                        warmth: warmth,
                        imageSize: { width: img.width, height: img.height }
                    });
                };
                
                img.src = currentImage;
            });
        }

        function generatePersonalizedStylingTips(analysis, imageFeatures) {
            const tips = [];
            
            // Face shape based tips
            if (analysis.faceShape === 'Round') {
                tips.push('Angular glasses frames ‡§Ü‡§™‡§ï‡•á round face ‡§ï‡•ã complement ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
                tips.push('Vertical lines ‡§µ‡§æ‡§≤‡•Ä shirts choose ‡§ï‡§∞‡•á‡§Ç - face ‡§ï‡•ã longer ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è');
                tips.push('Hair ‡§ï‡•ã sides ‡§∏‡•á ‡§ï‡§Æ ‡§∞‡§ñ‡•á‡§Ç, top ‡§™‡§∞ volume ‡§¨‡§¢‡§º‡§æ‡§è‡§Ç');
            } else if (analysis.faceShape === 'Square') {
                tips.push('Round ‡§Ø‡§æ oval glasses frames ‡§Ü‡§™‡§ï‡•á sharp features ‡§ï‡•ã soften ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
                tips.push('Layered haircut try ‡§ï‡§∞‡•á‡§Ç - sharp jawline ‡§ï‡•ã balance ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è');
                tips.push('Soft collar shirts ‡§™‡§π‡§®‡•á‡§Ç, pointed collars avoid ‡§ï‡§∞‡•á‡§Ç');
            } else if (analysis.faceShape === 'Oval') {
                tips.push('Lucky ‡§π‡•à‡§Ç ‡§Ü‡§™! Almost ‡§∏‡§≠‡•Ä styles suit ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã');
                tips.push('Bold patterns ‡§î‡§∞ statement accessories confidently wear ‡§ï‡§∞‡•á‡§Ç');
                tips.push('Different hair lengths experiment ‡§ï‡§∞‡•á‡§Ç - ‡§∏‡§¨ suit ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
            } else if (analysis.faceShape === 'Heart') {
                tips.push('Wider frames ‡§Ø‡§æ bottom-heavy glasses choose ‡§ï‡§∞‡•á‡§Ç');
                tips.push('Chin area ‡§™‡§∞ focus ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è light colored shirts ‡§™‡§π‡§®‡•á‡§Ç');
                tips.push('Side-swept hairstyles ‡§Ü‡§™‡§ï‡•á forehead ‡§ï‡•ã balance ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
            }

            // Skin tone based tips
            if (analysis.skinTone === 'Fair') {
                tips.push('Pastel colors ‡§î‡§∞ jewel tones ‡§Ü‡§™ ‡§™‡§∞ amazing ‡§≤‡§ó‡•á‡§Ç‡§ó‡•á');
                tips.push('Silver jewelry prefer ‡§ï‡§∞‡•á‡§Ç gold ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø');
                tips.push('Sun protection ‡§ú‡§∞‡•Ç‡§∞ use ‡§ï‡§∞‡•á‡§Ç - sensitive skin ‡§ï‡•á ‡§≤‡§ø‡§è');
            } else if (analysis.skinTone === 'Medium') {
                tips.push('Earth tones, blues, ‡§î‡§∞ greens ‡§Ü‡§™‡§ï‡•á complexion ‡§ï‡•ã enhance ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
                tips.push('Both gold ‡§î‡§∞ silver jewelry suit ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á ‡§Ü‡§™‡§ï‡•ã');
                tips.push('Bold colors confidently try ‡§ï‡§∞‡•á‡§Ç');
            } else if (analysis.skinTone === 'Dark' || analysis.skinTone === 'Deep') {
                tips.push('Bright colors ‡§î‡§∞ whites ‡§Ü‡§™ ‡§™‡§∞ stunning ‡§≤‡§ó‡•á‡§Ç‡§ó‡•á');
                tips.push('Gold jewelry ‡§Ü‡§™‡§ï‡•Ä skin tone ‡§ï‡•ã beautifully complement ‡§ï‡§∞‡•á‡§ó‡•Ä');
                tips.push('Rich jewel tones - emerald, sapphire, ruby colors try ‡§ï‡§∞‡•á‡§Ç');
            }

            // Image-based analysis tips
            if (imageFeatures.brightness < 100) {
                tips.push('Photo ‡§Æ‡•á‡§Ç lighting ‡§ï‡§Æ ‡§π‡•à - better lighting ‡§Æ‡•á‡§Ç photos ‡§≤‡•á‡§Ç for accurate analysis');
                tips.push('Natural daylight ‡§Æ‡•á‡§Ç mirror ‡§ï‡•á ‡§∏‡§æ‡§Æ‡§®‡•á outfit check ‡§ï‡§∞‡•á‡§Ç');
            } else if (imageFeatures.brightness > 200) {
                tips.push('Bright lighting detected - ‡§Ü‡§™‡§ï‡•Ä skin tone light colors ‡§Æ‡•á‡§Ç glowing ‡§≤‡§ó‡•á‡§ó‡•Ä');
            }

            if (imageFeatures.warmth > 0.1) {
                tips.push('Photo ‡§Æ‡•á‡§Ç warm tones ‡§π‡•à‡§Ç - autumn colors (browns, oranges) ‡§Ü‡§™ ‡§™‡§∞ great ‡§≤‡§ó‡•á‡§Ç‡§ó‡•á');
            } else if (imageFeatures.warmth < -0.1) {
                tips.push('Cool tones detected - blues, purples, ‡§î‡§∞ cool greys ‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è perfect ‡§π‡•à‡§Ç');
            }

            // Hair color specific tips
            if (analysis.hairColor === 'Black') {
                tips.push('Contrast create ‡§ï‡§∞‡•á‡§Ç - bright colors ‡§î‡§∞ whites boldly wear ‡§ï‡§∞‡•á‡§Ç');
                tips.push('Silver accessories ‡§Ü‡§™‡§ï‡•á black hair ‡§ï‡•á ‡§∏‡§æ‡§• stunning combination ‡§¨‡§®‡§æ‡§è‡§Ç‡§ó‡•á');
            } else if (analysis.hairColor === 'Brown') {
                tips.push('Warm earth tones ‡§Ü‡§™‡§ï‡•á brown hair ‡§ï‡•ã complement ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
                tips.push('Copper ‡§Ø‡§æ gold highlights consider ‡§ï‡§∞‡•á‡§Ç');
            } else if (analysis.hairColor === 'Blonde') {
                tips.push('Cool blues ‡§î‡§∞ purples ‡§Ü‡§™‡§ï‡•á blonde hair ‡§ï‡•á ‡§∏‡§æ‡§• beautiful contrast ‡§¨‡§®‡§æ‡§è‡§Ç‡§ó‡•á');
                tips.push('Minimalist jewelry styles ‡§Ü‡§™ ‡§™‡§∞ elegant ‡§≤‡§ó‡•á‡§Ç‡§ó‡•á');
            }

            // Body type specific tips
            if (analysis.bodyType === 'Slim') {
                tips.push('Layering techniques use ‡§ï‡§∞‡•á‡§Ç - jackets, scarves add ‡§ï‡§∞‡•á‡§Ç');
                tips.push('Horizontal stripes ‡§î‡§∞ patterns try ‡§ï‡§∞‡•á‡§Ç');
                tips.push('Fitted clothes ‡§™‡§π‡§®‡•á‡§Ç loose ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø');
            } else if (analysis.bodyType === 'Athletic') {
                tips.push('Tailored fits choose ‡§ï‡§∞‡•á‡§Ç - ‡§Ü‡§™‡§ï‡•Ä body structure ‡§ï‡•ã highlight ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è');
                tips.push('V-necks ‡§î‡§∞ structured blazers ‡§Ü‡§™ ‡§™‡§∞ perfect ‡§≤‡§ó‡•á‡§Ç‡§ó‡•á');
            } else if (analysis.bodyType === 'Curvy') {
                tips.push('Wrap dresses ‡§î‡§∞ belted outfits ‡§Ü‡§™‡§ï‡•Ä curves ‡§ï‡•ã beautifully accentuate ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á');
                tips.push('High-waisted bottoms choose ‡§ï‡§∞‡•á‡§Ç');
            }

            // Random additional personalized tips based on image hash
            const seedRandom = new SeededRandom(imageHash);
            const additionalTips = [
                '‡§Ü‡§™‡§ï‡•Ä personality ‡§ï‡•á ‡§≤‡§ø‡§è statement accessories add ‡§ï‡§∞‡•á‡§Ç',
                'Color coordination ‡§™‡§∞ focus ‡§ï‡§∞‡•á‡§Ç - maximum 3 colors per outfit',
                'Quality over quantity - few good pieces invest ‡§ï‡§∞‡•á‡§Ç',
                'Comfort ‡§ï‡•ã priority ‡§¶‡•á‡§Ç - confident feeling important ‡§π‡•à',
                'Seasonal colors try ‡§ï‡§∞‡•á‡§Ç - current season ‡§ï‡•á according',
                'Personal grooming ‡§™‡§∞ attention ‡§¶‡•á‡§Ç - clean, fresh look maintain ‡§ï‡§∞‡•á‡§Ç',
                'Posture improve ‡§ï‡§∞‡•á‡§Ç - confident body language style ‡§ï‡•ã enhance ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à'
            ];

            // Add 2-3 random additional tips
            for (let i = 0; i < 3; i++) {
                const randomTip = additionalTips[Math.floor(seedRandom.next() * additionalTips.length)];
                if (!tips.includes(randomTip)) {
                    tips.push(randomTip);
                }
            }

            return tips;
        }

        async function generatePersonalizedRecsWithImages(seedRandom, analysis) {
            // Analyze uploaded image
            const imageFeatures = await analyzeImageFeatures();
            
            const clothingOptions = [
                { name: 'Designer Shirt', desc: 'Premium quality formal shirt perfect for your skin tone', price: '‚Çπ1,999', store: 'Myntra' },
                { name: 'Casual T-Shirt', desc: 'Comfortable cotton t-shirt in recommended colors', price: '‚Çπ799', store: 'Amazon' },
                { name: 'Ethnic Wear', desc: 'Traditional outfit matching your face shape', price: '‚Çπ2,499', store: 'Ajio' },
                { name: 'Formal Blazer', desc: 'Professional blazer for office wear', price: '‚Çπ3,999', store: 'Myntra' },
                { name: 'Denim Jacket', desc: 'Trendy denim jacket for casual outings', price: '‚Çπ1,899', store: 'Amazon' },
                { name: 'Cotton Kurta', desc: 'Comfortable ethnic kurta for festivals', price: '‚Çπ1,299', store: 'Ajio' }
            ];

            const shoesOptions = [
                { name: 'Formal Shoes', desc: 'Leather shoes perfect for formal occasions', price: '‚Çπ2,999', store: 'Flipkart' },
                { name: 'Casual Sneakers', desc: 'Trendy sneakers for casual outings', price: '‚Çπ1,499', store: 'Amazon' },
                { name: 'Sports Shoes', desc: 'Performance shoes for gym and sports', price: '‚Çπ2,299', store: 'Amazon' },
                { name: 'Loafers', desc: 'Comfortable loafers for semi-formal wear', price: '‚Çπ1,799', store: 'Myntra' }
            ];

            const accessoriesOptions = [
                { name: 'Designer Watch', desc: 'Premium watch matching your style', price: '‚Çπ4,999', store: 'Myntra' },
                { name: 'Sunglasses', desc: 'UV protection glasses for your face shape', price: '‚Çπ1,299', store: 'Amazon' },
                { name: 'Wallet', desc: 'Leather wallet in recommended color', price: '‚Çπ899', store: 'Flipkart' },
                { name: 'Belt', desc: 'Designer leather belt for formal wear', price: '‚Çπ799', store: 'Amazon' },
                { name: 'Backpack', desc: 'Stylish backpack for daily use', price: '‚Çπ1,599', store: 'Flipkart' }
            ];

            const selectedClothing = [
                clothingOptions[Math.floor(seedRandom.next() * clothingOptions.length)],
                clothingOptions[Math.floor(seedRandom.next() * clothingOptions.length)],
                clothingOptions[Math.floor(seedRandom.next() * clothingOptions.length)]
            ];

            const selectedShoes = [
                shoesOptions[Math.floor(seedRandom.next() * shoesOptions.length)],
                shoesOptions[Math.floor(seedRandom.next() * shoesOptions.length)]
            ];

            const selectedAccessories = [
                accessoriesOptions[Math.floor(seedRandom.next() * accessoriesOptions.length)],
                accessoriesOptions[Math.floor(seedRandom.next() * accessoriesOptions.length)],
                accessoriesOptions[Math.floor(seedRandom.next() * accessoriesOptions.length)]
            ];

            const outfitCombinations = generateOutfitCombinations(seedRandom);
            const colorMatching = generateColorMatchingGuide(seedRandom);
            
            // Generate personalized styling tips based on image and analysis
            const personalizedStyling = generatePersonalizedStylingTips(analysis, imageFeatures);

            return {
                clothing: selectedClothing,
                shoes: selectedShoes,
                accessories: selectedAccessories,
                colors: ['Navy Blue', 'Charcoal Grey', 'Emerald Green', 'Burgundy', 'Classic Black'],
                styling: personalizedStyling,
                outfitCombinations: outfitCombinations,
                colorMatching: colorMatching,
                imageAnalysis: imageFeatures
            };
        }

        function displayAnalysisResults(data) {
            const resultsContainer = document.getElementById('results');
            
            let html = `
                <div class="person-card">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2 style="color: #2d3748; font-size: 2rem; margin-bottom: 15px;">
                            üéâ AI Style Analysis Results
                        </h2>
                        ${data.isConsistent ? '<div class="consistency-badge">‚úÖ Consistent Results Enabled</div>' : ''}
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="color: #4a5568; font-size: 1.1rem;">
                                üë• <strong>${data.detectedCount}</strong> person(s) detected in your photo
                            </div>
                        </div>
                        <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 15px; display: inline-block;">
                            <div style="font-size: 1.2rem; margin-bottom: 5px;">Overall Style Score</div>
                            <div style="font-size: 2.5rem; font-weight: bold;">${data.totalScore}/10</div>
                        </div>
                    </div>
            `;

            data.people.forEach(person => {
                const personTitle = data.detectedCount === 1 ? 'üë§ Your Style Analysis' : `üë§ Person ${person.id}`;
                
                html += `
                    <div style="border-top: 2px solid #e2e8f0; padding-top: 30px; margin-top: 30px;">
                        <div class="person-header">
                            <div class="person-title">${personTitle}</div>
                            <div class="beauty-score">Beauty Score: ${person.beautyScore}/10</div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üîç AI Face Analysis</div>
                            <div class="analysis-grid">
                                <div class="analysis-item">
                                    <div class="analysis-label">Face Shape</div>
                                    <div class="analysis-value">${person.analysis.faceShape}</div>
                                </div>
                                <div class="analysis-item">
                                    <div class="analysis-label">Skin Tone</div>
                                    <div class="analysis-value">${person.analysis.skinTone}</div>
                                </div>
                                <div class="analysis-item">
                                    <div class="analysis-label">Hair Color</div>
                                    <div class="analysis-value">${person.analysis.hairColor}</div>
                                </div>
                                <div class="analysis-item">
                                    <div class="analysis-label">Body Type</div>
                                    <div class="analysis-value">${person.analysis.bodyType}</div>
                                </div>
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üëî Perfect Clothing for You</div>
                            <div class="products-grid">
                                ${person.recommendations.clothing.map(item => `
                                    <div class="product-card">
                                        <img src="${productImages[item.name] || 'https://via.placeholder.com/300x200/667eea/FFFFFF?text=' + encodeURIComponent(item.name)}" 
                                             alt="${item.name}" class="product-image" />
                                        <div class="product-name">${item.name}</div>
                                        <div class="product-desc">${item.desc}</div>
                                        <div class="product-price">${item.price} - ${item.store}</div>
                                        <button class="buy-btn" onclick="purchaseProduct('${item.name}', '${item.store}')">
                                            üõí Buy Now via ${item.store}
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üëü Perfect Shoes for You</div>
                            <div class="products-grid">
                                ${person.recommendations.shoes.map(item => `
                                    <div class="product-card">
                                        <img src="${productImages[item.name] || 'https://via.placeholder.com/300x200/667eea/FFFFFF?text=' + encodeURIComponent(item.name)}" 
                                             alt="${item.name}" class="product-image" />
                                        <div class="product-name">${item.name}</div>
                                        <div class="product-desc">${item.desc}</div>
                                        <div class="product-price">${item.price} - ${item.store}</div>
                                        <button class="buy-btn" onclick="purchaseProduct('${item.name}', '${item.store}')">
                                            üõí Buy Now via ${item.store}
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üíé Perfect Accessories for You</div>
                            <div class="products-grid">
                                ${person.recommendations.accessories.map(item => `
                                    <div class="product-card">
                                        <img src="${productImages[item.name] || 'https://via.placeholder.com/300x200/667eea/FFFFFF?text=' + encodeURIComponent(item.name)}" 
                                             alt="${item.name}" class="product-image" />
                                        <div class="product-name">${item.name}</div>
                                        <div class="product-desc">${item.desc}</div>
                                        <div class="product-price">${item.price} - ${item.store}</div>
                                        <button class="buy-btn" onclick="purchaseProduct('${item.name}', '${item.store}')">
                                            üõí Buy Now via ${item.store}
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üé® Best Colors for Your Skin Tone</div>
                            <div class="colors-container">
                                ${person.recommendations.colors.map(color => `
                                    <div class="color-chip">${color}</div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üëî Complete Outfit Combinations</div>
                            <div style="background: #f8fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                                ${person.recommendations.outfitCombinations.map((outfit, index) => `
                                    <div style="background: white; margin: 15px 0; padding: 20px; border-radius: 12px; border-left: 4px solid #667eea;">
                                        <h4 style="color: #2d3748; margin-bottom: 15px; font-size: 1.2rem;">
                                            ${outfit.occasion} üëá
                                        </h4>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                            <div style="padding: 12px; background: #f7fafc; border-radius: 8px;">
                                                <strong style="color: #4a5568;">üëî Shirt/Top:</strong>
                                                <div style="color: #667eea; font-weight: 500;">${outfit.shirt}</div>
                                            </div>
                                            <div style="padding: 12px; background: #f7fafc; border-radius: 8px;">
                                                <strong style="color: #4a5568;">üëñ Bottom:</strong>
                                                <div style="color: #667eea; font-weight: 500;">${outfit.pants}</div>
                                            </div>
                                            <div style="padding: 12px; background: #f7fafc; border-radius: 8px;">
                                                <strong style="color: #4a5568;">üëü Shoes:</strong>
                                                <div style="color: #667eea; font-weight: 500;">${outfit.shoes}</div>
                                            </div>
                                            <div style="padding: 12px; background: #f7fafc; border-radius: 8px;">
                                                <strong style="color: #4a5568;">üï∂Ô∏è Accessories:</strong>
                                                <div style="color: #667eea; font-weight: 500;">${outfit.accessories}</div>
                                            </div>
                                        </div>
                                        <div style="margin-top: 15px; padding: 12px; background: #e6fffa; border-radius: 8px; border-left: 3px solid #38a169;">
                                            <strong style="color: #2f855a;">üí° Pro Tip:</strong>
                                            <span style="color: #4a5568; margin-left: 10px;">${outfit.tip}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">üé® Color Matching Guide</div>
                            <div style="background: #f8fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                                ${person.recommendations.colorMatching.map((match, index) => `
                                    <div style="background: white; margin: 15px 0; padding: 20px; border-radius: 12px; display: flex; align-items: center; gap: 20px; border: 1px solid #e2e8f0;">
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; color: #2d3748; margin-bottom: 8px;">
                                                ${match.baseColor} Shirt ‡§ï‡•á ‡§∏‡§æ‡§•:
                                            </div>
                                            <div style="color: #4a5568;">
                                                <strong>Pants:</strong> ${match.pantOptions.join(', ')} |
                                                <strong>Shoes:</strong> ${match.shoeOptions.join(', ')}
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <div style="width: 30px; height: 30px; border-radius: 50%; background: ${match.baseColorCode}; border: 2px solid #e2e8f0;"></div>
                                            <div style="color: #667eea; font-size: 1.2rem;">+</div>
                                            ${match.complementaryColors.map(color => `
                                                <div style="width: 25px; height: 25px; border-radius: 50%; background: ${color}; border: 1px solid #e2e8f0;"></div>
                                            `).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="analysis-section">
                            <div class="section-title">‚ú® Personal Styling Tips</div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px;">
                                ${person.recommendations.styling.map(tip => `
                                    <div style="margin: 8px 0; color: #4a5568; padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #667eea;">‚Ä¢ ${tip}</div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            resultsContainer.innerHTML = html;
        }

        function purchaseProduct(productName, store) {
            const storeData = affiliateData[store.toLowerCase()];
            const message = `
üõí Product: ${productName}
üè™ Store: ${store}
üí∞ Commission: ${storeData ? storeData.commission : '5-10%'}

Real app ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•ã affiliate link ‡§™‡§∞ redirect ‡§ï‡§∞‡•á‡§ó‡§æ‡•§

Demo Link: ${storeData ? storeData.base : 'https://example.com'}?ref=styleai&product=${encodeURIComponent(productName)}
            `;
            
            alert(message);
        }

        function showStatus(message, type) {
            const status = document.getElementById('status');
            if (status) {
                status.textContent = message;
                status.className = `status ${type}`;
                status.style.display = 'block';
                
                if (type === 'info') {
                    setTimeout(() => {
                        status.style.display = 'none';
                    }, 2000);
                }
            }
        }
    </script>
</body>
</html>